(this["webpackJsonpwerewolfhelper-client"]=this["webpackJsonpwerewolfhelper-client"]||[]).push([[0],{12:function(e,a,t){"use strict";function n(e){if(e.status>=200&&e.status<300)return e;var a=new Error("HTTP Error ".concat(e.statusText));throw a.status=e.statusText,a.response=e,console.log(a),a}function r(e){return e.json()}t.d(a,"b",(function(){return r})),t.d(a,"a",(function(){return n}))},31:function(e,a,t){"use strict";(function(e){var n=t(20),r=t(0),c=t.n(r),o=t(18),s=t(3),l=t(5),i=t(13),u=t(7),m=t(11),p=t(32),h=t(36),d=t(35);a.a=function(){var a=Object(r.useState)(""),t=Object(n.a)(a,2),f=t[0],b=t[1],E=Object(r.useState)(""),v=Object(n.a)(E,2),g=v[0],y=v[1],j=Object(r.useState)("auth"),C=Object(n.a)(j,2),N=C[0],O=C[1];return Object(r.useEffect)((function(){fetch("/read-cookie",{method:"GET"}).then((function(e){return e.json()})).then((function(e){void 0!==e.screen&&O(e.screen)})).catch((function(e){O("auth"),console.log(e)}))}),[]),c.a.createElement("div",{className:"App"},"auth"===N?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{md:{span:5,offset:3}},c.a.createElement(l.a,{className:"mb-3"},c.a.createElement(l.a.Prepend,null,c.a.createElement(l.a.Text,null,"\u7528\u6236\u540d")),c.a.createElement(i.a,{"aria-label":"Small","aria-describedby":"inputGroup-sizing-sm",name:"username",placeholder:"\u4f60\u7684\u540d\u5b57",value:f,onChange:function(e){return b(e.target.value)}}))),c.a.createElement(m.a,{md:{span:5,offset:3}},c.a.createElement(l.a,{className:"mb-3"},c.a.createElement(l.a.Prepend,null,c.a.createElement(l.a.Text,null,"\u5bc6\u78bc")),c.a.createElement(i.a,{"aria-label":"Small","aria-describedby":"inputGroup-sizing-sm",name:"password",placeholder:"\u5bc6\u78bc",value:g,onChange:function(e){return y(e.target.value)},type:"password"}))),c.a.createElement(m.a,{md:{span:3,offset:3}},c.a.createElement(u.a,{onClick:function(){var a=new Headers;a.set("Authorization","Basic "+e.from(f+":"+g).toString("base64")),a.set("Content-Type","application/json"),fetch("/authenticate",{method:"GET",mode:"cors",headers:a}).then((function(e){return e.json()})).then((function(e){void 0!==e.screen&&O(e.screen),localStorage.setItem("username",f)})).catch((function(e){console.error(e)}))}},"\u767b\u5165"),c.a.createElement(u.a,{onClick:function(){fetch("/register",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:f,password:g})}).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch((function(e){return console.error(e)}))}},"\u8a3b\u518a"))):c.a.createElement(o.a,null,c.a.createElement(s.a,{exact:!0,path:"/",render:function(){return c.a.createElement(p.a,{username:f})}}),c.a.createElement(s.a,{path:"/createroom",component:h.a}),c.a.createElement(s.a,{path:"/room/:roomid",component:d.a})))}}).call(this,t(43).Buffer)},32:function(e,a,t){"use strict";var n=t(14),r=t(17),c=t(16),o=t(0),s=t.n(o),l=t(18),i=t(7),u=t(21),m=t(19),p=t(5),h=t(13),d=function(e){Object(r.a)(t,e);var a=Object(c.a)(t);function t(e){var r;return Object(n.a)(this,t),(r=a.call(this,e)).onChangeRoomID=function(e){r.setState({roomid:e.target.value})},r.render=function(){return s.a.createElement("div",{className:"text-center"},s.a.createElement(p.a,{size:"lg",className:"mb-3"},s.a.createElement(p.a.Prepend,null,s.a.createElement(p.a.Text,{id:"inputGroup-sizing-sm"},"\u623f\u9593ID")),s.a.createElement(h.a,{"aria-label":"Small","aria-describedby":"inputGroup-sizing-sm",value:r.state.roomid,onChange:r.onChangeRoomID}),s.a.createElement(l.b,{to:{pathname:"/room/".concat(r.state.roomid)}},s.a.createElement(i.a,{size:"lg",disabled:!r.state.roomid},"\u52a0\u5165\u623f\u9593"))))},r.state={roomid:""},r}return t}(s.a.Component);a.a=function(e){return s.a.createElement(m.a,{className:"p-3"},s.a.createElement(u.a,null,s.a.createElement("h1",{className:"header"},"\u72fc\u4eba\u6bba\u9762\u6bba\u52a9\u624bv1"),s.a.createElement("h1",{className:"header"},"\u4f60\u597d\uff0c",e.username),s.a.createElement("div",{className:"text-center"},s.a.createElement(l.b,{to:"/createroom"},s.a.createElement(i.a,{size:"lg"},"\u5275\u5efa\u623f\u9593"))),s.a.createElement(d,null)))}},35:function(e,a,t){"use strict";t.d(a,"a",(function(){return b}));var n=t(14),r=t(17),c=t(16),o=t(0),s=t.n(o),l=t(5),i=t(13),u=t(19),m=t(21),p=t(11),h=t(26),d=t(12);function f(e){return s.a.createElement(p.a,null,s.a.createElement(l.a,{className:"mb-3"},s.a.createElement(l.a.Prepend,null,s.a.createElement(l.a.Text,null,e.number+1)),s.a.createElement(i.a,{"aria-label":"Small","aria-describedby":"inputGroup-sizing-sm",value:e.name,onChange:function(a){var t=a.target.value;e.setPlayerName(e.number,t)}})))}var b=function(e){Object(r.a)(t,e);var a=Object(c.a)(t);function t(e){var r;return Object(n.a)(this,t),(r=a.call(this,e)).componentDidMount=function(){fetch("/api/room?roomid=".concat(r.props.match.params.roomid),{method:"GET",accept:"application: json",mode:"cors"}).then(d.a).then(d.b).then((function(e){console.log(e),r.setState({valid:!0,numPlayers:e.players,characters:e.characters})})).catch((function(e){console.log("Error "+e)})),fetch("/api/characters",{method:"GET",accept:"application: json",mode:"cors"}).then(d.a).then(d.b).then((function(e){r.setState({charactersMapping:e})})).catch((function(e){console.log("Fetch character error "+e)}))},r.setPlayerName=function(e,a){r.setState((function(t){var n=t.players;return n[e]=a,{players:n}}))},r.render=function(){if(!r.state.valid)return s.a.createElement("div",null,"\u623f\u9593 ",r.props.match.params.roomid," \u4e0d\u5b58\u5728\u3002 \u8acb\u5148\u5275\u5efa\u623f\u9593\u3002");var e="";Object.keys(r.state.characters).forEach((function(a){var t=r.state.characters[a];e+=t>0?r.state.charactersMapping[a]+t:""}));for(var a=[],t=0;t<12;t+=2)a.push(s.a.createElement(h.a,{key:t},s.a.createElement(f,{number:t,name:r.state.players[t],setPlayerName:r.setPlayerName}),s.a.createElement(f,{number:t+1,name:r.state.players[t+1],setPlayerName:r.setPlayerName})));return s.a.createElement(u.a,{className:"p-3"},s.a.createElement(m.a,null,s.a.createElement(h.a,null,s.a.createElement(p.a,null,"\u623f\u9593ID: ",r.props.match.params.roomid),s.a.createElement(p.a,null,"\u7248\u5b50\b: ",e,".")),a))},r.state={valid:!1,players:Array(12).fill("\u4f60\u7684\u540d\u5b57"),numPlayers:0,characters:{},charactersMapping:{}},r}return t}(s.a.Component)},36:function(e,a,t){"use strict";t.d(a,"a",(function(){return g}));var n=t(20),r=t(14),c=t(22),o=t(17),s=t(16),l=t(0),i=t.n(l),u=t(7),m=t(19),p=t(18),h=t(5),d=t(13),f=t(11),b=function(e){Object(o.a)(t,e);var a=Object(s.a)(t);function t(){var e;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=a.call.apply(a,[this].concat(c))).handleChange=function(a){var t=a.target.value;!isNaN(t)&&t>0&&e.props.setCharNumber(e.props.name,t)},e.onClickAdd=function(){e.props.setCharNumber(e.props.name,e.props.number+1)},e.onClickDeduct=function(){e.props.setCharNumber(e.props.name,e.props.number-1)},e}return Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(f.a,{md:{span:3,offset:4}},i.a.createElement(h.a,{className:"mb-3"},i.a.createElement(h.a.Prepend,null,this.props.number>0?i.a.createElement(u.a,{disabled:!0,variant:"secondary"},this.props.cname):i.a.createElement(u.a,{disabled:!0,variant:"outline-secondary"},this.props.cname),i.a.createElement(u.a,{onClick:this.onClickDeduct,disabled:0===this.props.number}," - ")),i.a.createElement(d.a,{"aria-label":"Small","aria-describedby":"inputGroup-sizing-sm",type:"number",value:this.props.number,onChange:this.handleChange}),i.a.createElement(h.a.Append,null,i.a.createElement(u.a,{onClick:this.onClickAdd}," + "))))}}]),t}(i.a.Component),E=t(12);function v(e,a){for(var t in e)if(t in a){if(e[t]!==a[t])return!1}else if(0!==e[t])return!1;return!0}var g=function(e){Object(o.a)(t,e);var a=Object(s.a)(t);function t(e){var c;return Object(r.a)(this,t),(c=a.call(this,e)).setCharNumber=function(e,a){c.setState((function(t){var n=t.characters;return n[e]=parseInt(a),{characters:n,players:function(e){var a=0;for(var t in e)e.hasOwnProperty(t)&&(a+=parseFloat(e[t]));return a}(n)}}),(function(){return c.validateRoom()}))},c.validateRoom=function(){for(var e in c.state.boards)if(v(c.state.characters,c.state.boards[e])){c.setState({isValidRoom:!0}),console.log("Found equal room!");break}},c.onClickCreateRoom=function(){fetch("/api/room",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({time:c.state.time,players:c.state.players,characters:c.state.characters})}).then((function(e){return e.json()})).then((function(e){console.log(e),c.setState({hasResult:!0,roomid:e.roomid})})).catch((function(e){console.err(e)}))},c.onClickSetBoard=function(e){var a=c.state.boards[e],t=c.state.characters,n=0;for(var r in t)r in a?(t[r]=a[r],n+=parseInt(a[r])):t[r]=0;c.setState({characters:t,isValidRoom:!0,players:n})},c.render=function(){var e=Object.keys(c.state.boards).map((function(e){return i.a.createElement(u.a,{key:e,className:"mr-1 mb-1",size:"md",variant:"outline-info",onClick:function(){c.onClickSetBoard(e)}},e)})),a=Object.entries(c.state.charactersMapping).map((function(e,a){var t=Object(n.a)(e,2),r=t[0],o=t[1];return i.a.createElement(b,{key:a,cname:o,name:r,number:c.state.characters[r],setCharNumber:c.setCharNumber})})),t="/room/"+c.state.roomid;return i.a.createElement(m.a,{className:"p-3"},i.a.createElement("div",{className:"text-center"},e,a,i.a.createElement(u.a,{size:"lg",disabled:!c.state.isValidRoom,onClick:c.onClickCreateRoom},"\u5275\u9020\u623f\u9593"),c.state.isValidRoom?null:i.a.createElement("div",null,"\u623f\u9593\u4e0d\u7b26\u5408\u5df2\u5b58\u5728\u7684\u677f\u5b50\u3002"),c.state.hasResult?i.a.createElement(p.b,{to:t},i.a.createElement(u.a,{size:"lg"},"\u9032\u5165\u623f\u9593 ",c.state.roomid," ")):null))},c.state={isValidRoom:!1,roomid:"",time:120,players:0,characters:{},charactersMapping:{},boards:{},hasResult:!1},c}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/api/characters",{method:"GET",accept:"application: json",mode:"cors"}).then(E.a).then(E.b).then((function(a){var t={};Object.keys(a).forEach((function(e){t[e]=0})),e.setState({characters:t,charactersMapping:a})})).catch((function(e){console.log("Fetch character error "+e)})),fetch("/api/boards",{method:"GET",accept:"application: json",mode:"cors"}).then(E.a).then(E.b).then((function(a){e.setState({boards:a})})).catch((function(e){console.log("Fetch character error "+e)}))}}]),t}(i.a.Component)},37:function(e,a,t){e.exports=t(38)},38:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(30),o=t.n(c),s=t(31);t(54),t(55);o.a.render(r.a.createElement(s.a,null),document.getElementById("root"))},54:function(e,a,t){}},[[37,1,2]]]);
//# sourceMappingURL=main.27d087cc.chunk.js.map